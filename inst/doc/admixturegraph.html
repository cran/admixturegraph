<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Thomas Mailund &amp; Kalle Leppälä" />

<meta name="date" content="2016-06-10" />

<title>Constructing and fitting admixture graphs to D statistics</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Constructing and fitting admixture graphs to D statistics</h1>
<h4 class="author"><em>Thomas Mailund &amp; Kalle Leppälä</em></h4>
<h4 class="date"><em>2016-06-10</em></h4>
</div>


<p>This document describes the <code>admixturegraph</code> package, a package for fitting admixture graphs to genetic data.</p>
<p>The package enables you to:</p>
<ul>
<li>specify and visualize admixture graphs</li>
<li>extract the implied equations a given graph makes for predicting correlations of genetic drift as specified by the expected <span class="math">\(f_2\)</span>, <span class="math">\(f_3\)</span> and <span class="math">\(f_4\)</span> statistics</li>
<li>fit a graph to data summarized as <span class="math">\(D\)</span> statistics and test the goodness of fit</li>
<li>explore the graph space over a given set of populations with combination of brute force and heuristics</li>
</ul>
<div id="admixture-graphs-and-genetic-drift" class="section level1">
<h1>Admixture graphs and genetic drift</h1>
<p>Gene frequencies in related populations are correlated. If two populations split apart a certain time in the past, all gene frequencies were the same at that split time — where the populations were one and the same — and has since drifted apart in the time since — where the populations have evolved independently.</p>
<p>With three related populations where one branched off a common ancestor early and the other two later in time the two closest related populations will, all else being equal, have more correlated gene frequencies than they have with the third population.</p>
<p>All else being equal here means that the populations should have evolved at roughly the same speed — the gene frequency changes should not be more dramatic in one population than another. If we consider populations A, B and C, with A and B closest relatives but where population A has changed very rapidly since it split from population B, then gene frequencies in A and B could be less correlated than between B and C (but A and C would be even less correlated).</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The way gene frequencies change over time as a population evolve is called genetic drift and the way gene frequencies are correlated between populations is determined by how they are related. These relationships can be simple trees with ancestral populations split into descendant populations or more complex graphs with gene flow between diverged populations.</p>
<p>Assuming that populations evolve by either splitting into descendant populations or merging in admixture events — but do not experience periods of continuous gene flow — their relationship can be described as a so-called <em>admixture graph</em> <span class="citation">(Patterson et al. 2012)</span>. Such a graph not only describes the history of the populations but can also be seen as a specification of how gene frequencies in the populations will be correlated. Different summary statistics can capture the correlations in gene frequencies between populations, extracting different aspects of this correlation, and the expected values of these statistics can be computed as polynomials over branch lengths and admixture proportions in the admixture graph.</p>
</div>
<div id="building-and-visualizing-admixture-graphs" class="section level1">
<h1>Building and visualizing admixture graphs</h1>
<p>In the <code>admixturegraph</code> package, graphs are built by specifying the edges in the graph and naming the admixture proportions so these have a variable associated.</p>
<p>It is first necessary to specify the nodes in the graphs, where there is a distinction between leaves and inner nodes so leaves later can correspond to values in <span class="math">\(f\)</span> statistics computed from genetic data. It is necessary to name the nodes so we have something to refer to when specifying the edges.</p>
<p>Edges are specified by specifying the parent of each node. Only one node is allowed not to have a parent; the package cannot deal with more than one root.</p>
<p>The tree shown above is specified as:</p>
<pre class="sourceCode r"><code class="sourceCode r">leaves &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)
inner_nodes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AB&quot;</span>, <span class="st">&quot;ABC&quot;</span>)
edges &lt;-<span class="st"> </span><span class="kw">parent_edges</span>(<span class="kw">c</span>(<span class="kw">edge</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;AB&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;AB&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;AB&quot;</span>, <span class="st">&quot;ABC&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;ABC&quot;</span>)))
graph &lt;-<span class="st"> </span><span class="kw">agraph</span>(leaves, inner_nodes, edges, <span class="ot">NULL</span>)</code></pre>
<p>and plotted like:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(graph)  </code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>By default the labels on inner nodes are not shown but this can be changed by:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(graph, <span class="dt">show_inner_node_labels =</span> <span class="ot">TRUE</span>)  </code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The shape of the output of the plotting algorithm is determined by heuristics designed to make the graph visually pleasing. However, the user has the final say on the shape if what the heuristics propose is not satisfactory (like the non-alphabetical order of leaves in the example above).</p>
<p>Admixture events are specified by having admixture edges. These are edges with two parents. Admixture edges really represent two different edges, capturing the drift between the two populations ancestral to the admixture event before the admixture took place, so we typically have to add inner nodes on the edges where these two ancestral populations branched off other lineages in the graph.</p>
<pre class="sourceCode r"><code class="sourceCode r">leaves &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)
inner_nodes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;ABC&quot;</span>)
edges &lt;-<span class="st"> </span><span class="kw">parent_edges</span>(<span class="kw">c</span>(<span class="kw">edge</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;a&quot;</span>), <span class="kw">edge</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;ABC&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="kw">edge</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;ABC&quot;</span>),
                        <span class="kw">admixture_edge</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>)))
graph &lt;-<span class="st"> </span><span class="kw">agraph</span>(leaves, inner_nodes, edges, <span class="ot">NULL</span>)

<span class="kw">plot</span>(graph, <span class="dt">show_inner_node_labels =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Since we usually model admixtures that happened at some point in the past we usually also need an inner node above the present day admixed population.</p>
<pre class="sourceCode r"><code class="sourceCode r">leaves &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)
inner_nodes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;ABC&quot;</span>)
edges &lt;-<span class="st"> </span><span class="kw">parent_edges</span>(<span class="kw">c</span>(<span class="kw">edge</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;a&quot;</span>), <span class="kw">edge</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;ABC&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="kw">edge</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;ABC&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;b&quot;</span>),
                        <span class="kw">admixture_edge</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>)))
graph &lt;-<span class="st"> </span><span class="kw">agraph</span>(leaves, inner_nodes, edges, <span class="ot">NULL</span>)

<span class="kw">plot</span>(graph, <span class="dt">show_inner_node_labels =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This graph doesn’t contain a variable for the admixture proportions between the two ancestral populations to B. To work with the equations for expected drift statistics we need to specify this as well.</p>
<p>This is done through the last parameter when constructing the admixture graph, like this:</p>
<pre class="sourceCode r"><code class="sourceCode r">leaves &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)
inner_nodes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;ABC&quot;</span>)
edges &lt;-<span class="st"> </span><span class="kw">parent_edges</span>(<span class="kw">c</span>(<span class="kw">edge</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;a&quot;</span>), <span class="kw">edge</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;ABC&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="kw">edge</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;ABC&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;b&quot;</span>),
                        <span class="kw">admixture_edge</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>)))
admixtures &lt;-<span class="st"> </span><span class="kw">admixture_proportions</span>(<span class="kw">c</span>(
    <span class="kw">admix_props</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;x&quot;</span>)
    ))
graph &lt;-<span class="st"> </span><span class="kw">agraph</span>(leaves, inner_nodes, edges, admixtures)

<span class="kw">plot</span>(graph, <span class="dt">show_inner_node_labels =</span> <span class="ot">TRUE</span>, <span class="dt">show_admixture_labels =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6ZmY6kLY6kNtmAABmADpmZmZmtv+QOgCQtpCQ2/+azTK2ZgC225C2///bkDrb////tmb/25D//7b//9v///86S5EIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHH0lEQVR4nO2djXbiNhBG3W3StMkmNCVLIeT9n7PIJuAf2XcsyZag3z1n2V2wZqwbWTaRLFdfYpIq9w6UjgQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgQUK2j/2/vp9fBYnbj882H9/ShV0HHz6mwcnn6dXvc/ftV/jpv1DZUq6PD04dw0gj5/vn++vLl3/3hfe0dKFbR7+No+X1rQQ92AslCooFOb+dr//u+5D6qe6/9koVBBzoc7qpoWdDqyJKjDcVM3nIfvPujlTYdYh0vD6XXSzeuqlClo25zOt8+NoN3p+NqdLoaOm/UPtCIFuS7asf/xUXfS9eG1r3ShWCISBEgQIEGABAESBEgQIEGABAGlC6rO5NuBbJlNVFVuQ2ULOon5pyafoaIFXfw4Q7n2IVNeE1c/+QxJEO1DnrQ2JAiQIECCAAkCdJondKEIVG0y7UKetDbadnIZKllQ10kmQwUL6hvJY6hcQUMfWQwVK8hnI4ehvILGx9v9LrzvuklWy036yCrIzWZpZrP2GWsrnvev86wWIfsh9j2To8P4sTT8ZOG5Z3kFuaPD04Km+prBZ7s7FuRm9Xpa0HRf3P/0nluQm3i4HbQgOlf1Pq/7oOXmT2cV5OZq/rXpnYH4XN7b4I7PYj4s1zprXg6VJsh0LbjmBWNhgoxVX9FQWYLMFV/PUFGCZlR7NUMlCZpV6bUMFSRoZpVXMlSOoNkVXsdQMYICqruKoVIEBVV2DUNZBV0HdAKreh7uWHJUKKegBKNey4+bZRTUHjYN3o3Fx14zTh9NMfC+/Oh9TkEJpm4sP/9DgijDEkFtmSUIMksQZJYgyCxBkFmneUqd4hrvji8UE93Kc8dfNVqVSxEk1U71wy8U15i9ur76OfbHFQNiRJG5BXX/9oCCDDGiKETQ6G6QoOqeBV3rNCXo1a3QFRUjijIEjdfOLRk0saySJUQc5Qt6u6y3FBgijqwXimP/aVEL2o0JMoWI4yYEbcc6obsWNJhH793K9UGHx5E+yBYijvIFjZ/FhvcqJNmxXpIFYtoS9zOHjKzGRrAkWSCmLfFQ0OyxeX4nnnIEza7efQvy1WXu9JfYCLY0ySMa80rQdFpv3nkzzGIjGPOkDmhMK0GQ1p93ziTOyADmRKkD2rKOpI2fBpzcUFmCzPWLDmAmi6CJWgyvjn2/kp8RIJbCBY0M6vyPBfV/g+EdFjSXT0AOQZN1aH84NrBsDpCA4gR1f4vqnZpgLp+CDIKgBrGCEhsqT1CrY+4Kso7C37og3H8JmrFp0PSopIYkiIIljGVLOOsbe9j8sZSGihY0dqGYNAfFShfKlm9ewsD5YwkNFS5o5Mtq6ixToZJFMuabn3CdIqOhkkWypQvIt1aZkUipAhnTBVV2/gJTtyooaL+r6mX+8/uSGboJQX/OX6LsrgW5p/UdHi9TOoaHWG+D8EwGVhVk3evtQ3vOlKcP6m4QlYsoUtBx89pamMwjqLtBVC5iTUH2fd6319y6CtpdlqXc86JciQwVKejz59+tNuNpQd0NIrNBmCRRbKmsuY6b5/bqiENBvQ0i00GYJFFsqay5tvWDni9Tf4eCehvE5puOkiKIMVVgrrXL9aKkCGLLFJpq/YKdIAliGDNJ0HSi4Ew5SrZixIcwJpIgSCRB03nCE+UpegkRHcGYR4LGEsTdtR1XPMV9+RFlTfHj7o2PKx6ZvIkRXtQUPm7liLjikcnPQYJLmqLHrT0SVzwy+XeU4JKm6HGr18QVT7N0jgRRlNCCtugSBNElCKJLEESXIIiu0zyF14UixddXDUqgL6v3jQQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBwAqC/A9Mt+Gewut9XvaM8jSXcZrlBR03r+G72Ezf3M+/maXBFTxuogwtL+jw9DH/XpRrYVfU+0x6A806y3FPyl5e0I7vqxjn3IIC20Bwy2uxuCD30w9/JHzTB00tST5FikfRLy5oX0/6Dn3cedOCQg+SWxDkHilfhZ9Jzn1QoOBbOMTimkCSTjq8/TqWFnRejj60m24E4Y0rY7hbE92S3WGlaxYW9P2zD23sTScdfqTsIw7vBn3VACQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAv4DY4/AsmXpew0AAAAASUVORK5CYII=" /><!-- --></p>
<p>As a somewhat more complex example we build a graph for samples of polar and brown bears described in <span class="citation">(Cahill et al. 2015)</span>. Although the brown bears from mainland Alaska and even from Sweden were found to have some polar bear ancestry, the most remarkable episode of polar bear gene flow was into the population of brown bears that colonized Admiralty, Baranof and Chichagof islands of Alaska (the ABC bears).</p>
<p>A graph constructed to capture this main gene flow could look like this (the parameter <code>platform</code> is to make the horizontal lines around the admixture node a bit wider to make room for the labels, for more options on customising the graph plots see the documentation of <code>plot.agraph</code>):</p>
<pre class="sourceCode r"><code class="sourceCode r">leaves &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BLK&quot;</span>, <span class="st">&quot;PB&quot;</span>, <span class="st">&quot;Adm1&quot;</span>, <span class="st">&quot;Adm2&quot;</span>, <span class="st">&quot;Bar&quot;</span>, <span class="st">&quot;Chi1&quot;</span>, <span class="st">&quot;Chi2&quot;</span>, <span class="st">&quot;Denali&quot;</span>, <span class="st">&quot;Kenai&quot;</span>, <span class="st">&quot;Sweden&quot;</span>) 
inner_nodes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;u&quot;</span>, <span class="st">&quot;v&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;M&quot;</span>)
edges &lt;-<span class="st"> </span><span class="kw">parent_edges</span>(<span class="kw">c</span>(<span class="kw">edge</span>(<span class="st">&quot;BLK&quot;</span>, <span class="st">&quot;R&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;PB&quot;</span>, <span class="st">&quot;s&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;Adm1&quot;</span>, <span class="st">&quot;x&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;Adm2&quot;</span>, <span class="st">&quot;x&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;Bar&quot;</span>, <span class="st">&quot;y&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;Chi1&quot;</span>, <span class="st">&quot;z&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;Chi2&quot;</span>, <span class="st">&quot;z&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;Denali&quot;</span>, <span class="st">&quot;v&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;Kenai&quot;</span>, <span class="st">&quot;u&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;Sweden&quot;</span>, <span class="st">&quot;t&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;r&quot;</span>, <span class="st">&quot;R&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;s&quot;</span>, <span class="st">&quot;r&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;t&quot;</span>, <span class="st">&quot;r&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;u&quot;</span>, <span class="st">&quot;t&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;v&quot;</span>, <span class="st">&quot;u&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;M&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;w&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;w&quot;</span>),
                        <span class="kw">edge</span>(<span class="st">&quot;z&quot;</span>, <span class="st">&quot;y&quot;</span>),
                        <span class="kw">admixture_edge</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;v&quot;</span>)))
admixtures &lt;-<span class="st"> </span><span class="kw">admixture_proportions</span>(<span class="kw">c</span>(<span class="kw">admix_props</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;v&quot;</span>, <span class="st">&quot;a&quot;</span>)))
bears_graph &lt;-<span class="st"> </span><span class="kw">agraph</span>(leaves, inner_nodes, edges, admixtures)

<span class="kw">plot</span>(bears_graph, <span class="dt">platform =</span> <span class="fl">1.4</span>, <span class="dt">show_admixture_labels =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; fminbnd:  Exiting: Maximum number of function evaluations has been exceeded</span>
<span class="co">#&gt;          - increase MaxFunEvals option.</span>
<span class="co">#&gt;          Current function value: 1996.21962478791</span></code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="extracting-drift-equations-for-expected-f-statistics" class="section level1">
<h1>Extracting drift equations for expected <span class="math">\(f\)</span> statistics</h1>
<p>The expectation of <span class="math">\(f_2\)</span>, <span class="math">\(f_3\)</span>, and <span class="math">\(f_4\)</span> statistics can be expressed in terms of admixture proportions and edge lengths of an admixture graph <span class="citation">(Patterson et al. 2012)</span>. In the <code>admixturegraph</code> package these can be extracted from a graph using the functions <code>sf2</code>, <code>sf3</code> and <code>sf4</code> (where the “s” stands for “symbolic”).</p>
<p>The expected values are computed from weighted overlapping paths between pairs of edges such that <span class="math">\(f_4(A,B;C,D)\)</span> is the sum of overlapping paths from <span class="math">\(A\)</span> to <span class="math">\(B\)</span> with paths from <span class="math">\(C\)</span> to <span class="math">\(D\)</span>, weighted by the probability of lineages taking each path. The <span class="math">\(f_2\)</span> and <span class="math">\(f_3\)</span> statistics can be seen as special cases of <span class="math">\(f_4\)</span> statistics: <span class="math">\(f_3(A;B,C)=f_4(A,B;A,C)\)</span> and <span class="math">\(f_2(A,B)=f_4(A,B;A,B)\)</span>.</p>
<p>The expressions extracted using the <code>sf2</code>, <code>sf3</code>, and <code>sf4</code> functions are in the form of (non-simplified) R expressions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sf2</span>(bears_graph, <span class="st">&quot;Bar&quot;</span>, <span class="st">&quot;Chi1&quot;</span>)
<span class="co">#&gt; expression(edge_y_Bar + edge_y_z + edge_z_Chi1)</span>
<span class="kw">sf3</span>(bears_graph, <span class="st">&quot;Bar&quot;</span>, <span class="st">&quot;Chi1&quot;</span>, <span class="st">&quot;Chi2&quot;</span>)
<span class="co">#&gt; expression(edge_y_Bar + edge_y_z)</span>
<span class="kw">sf4</span>(bears_graph, <span class="st">&quot;BLK&quot;</span>, <span class="st">&quot;Chi1&quot;</span>, <span class="st">&quot;Bar&quot;</span>, <span class="st">&quot;Chi2&quot;</span>)
<span class="co">#&gt; expression(a * (edge_y_z) + (1 - a) * (edge_y_z))</span></code></pre>
</div>
<div id="fitting-admixture-graphs-to-observed-f-statistics" class="section level1">
<h1>Fitting admixture graphs to observed <span class="math">\(f\)</span> statistics</h1>
<p>Given a data set summarized as <span class="math">\(f\)</span> (or <span class="math">\(D\)</span>) statistics <code>admixturegraph</code> can fit the edge lengths and admixture proportions of a graph to the data.</p>
<p>For fitting data the package expects the observed statistics in a data frame with at least the following columns: <code>W</code>, <code>X</code>, <code>Y</code>, and <code>Z</code> determining the statistic <span class="math">\(f_4(W,X,Y,Z)\)</span> and <code>D</code>, the actual value of the statistic (called <span class="math">\(D\)</span> since that is the header used if these are computed with Patterson et al.s <code>ADMIXTOOLS</code> package). Optionally, the data frame might also contain <code>Z.values</code>, the statistics divided by the standard error.</p>
<p>For the bear samples we have the following statistics <span class="citation">(Cahill et al. 2015)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(bears)
bears
<span class="co">#&gt;      W  X      Y      Z      D Z.value</span>
<span class="co">#&gt; 1  BLK PB Sweden   Adm1 0.1258    12.8</span>
<span class="co">#&gt; 2  BLK PB  Kenai   Adm1 0.0685     5.9</span>
<span class="co">#&gt; 3  BLK PB Denali   Adm1 0.0160     1.3</span>
<span class="co">#&gt; 4  BLK PB Sweden   Adm2 0.1231    12.2</span>
<span class="co">#&gt; 5  BLK PB  Kenai   Adm2 0.0669     6.1</span>
<span class="co">#&gt; 6  BLK PB Denali   Adm2 0.0139     1.1</span>
<span class="co">#&gt; 7  BLK PB Sweden    Bar 0.1613    14.7</span>
<span class="co">#&gt; 8  BLK PB  Kenai    Bar 0.1091     8.9</span>
<span class="co">#&gt; 9  BLK PB Denali    Bar 0.0573     4.3</span>
<span class="co">#&gt; 10 BLK PB Sweden   Chi1 0.1786    17.7</span>
<span class="co">#&gt; 11 BLK PB  Kenai   Chi1 0.1278    11.3</span>
<span class="co">#&gt; 12 BLK PB Denali   Chi1 0.0777     6.4</span>
<span class="co">#&gt; 13 BLK PB Sweden   Chi2 0.1819    18.3</span>
<span class="co">#&gt; 14 BLK PB  Kenai   Chi2 0.1323    12.1</span>
<span class="co">#&gt; 15 BLK PB Denali   Chi2 0.0819     6.7</span>
<span class="co">#&gt; 16 BLK PB Sweden Denali 0.1267    14.3</span>
<span class="co">#&gt; 17 BLK PB  Kenai Denali 0.0571     5.6</span>
<span class="co">#&gt; 18 BLK PB Sweden  Kenai 0.0719     9.6</span></code></pre>
<p>Since we have the <code>Z.values</code> we may visualize the statistics together with their confidence intervals (now the observations are considered as samples from a multivariate normal distribution):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">f4stats</span>(bears))</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Fitting the graph above to this data is done either with <code>fit_graph</code> (lots of details about the fit) or <code>fast_fit</code> (only the essentials but a bit faster, designed for usage in big loops).</p>
<p>Both functions use a combination of linear algebra and numerical optimisation (Nelder-Mead) to find the edge lengths and admixture proportions that minimize the value of <span class="math">\((F-f)^t*S^{-1}*(F-f)\)</span>. Here <span class="math">\(F\)</span> and <span class="math">\(f\)</span> are the vectors of predicted (from the graph with <code>sf4</code> etc.) and observed (<code>D</code> from the data frame) statistics, respectively, and <span class="math">\(S\)</span> is the covariance matrix of the observed statistics <span class="math">\(f\)</span>, either given by the user or replaced by a default proxy of the identity matrix or a diagonal matrix constructed from the <code>Z.values</code>. This cost function <span class="math">\((F-f)^t*S^{-1}*(F-f)\)</span> can be interpreted as the log likelihood of the graph parameters (edge lengths and admixture proportions), up to an affine normalization. See the documentation of <code>cost_function</code>, <code>edge_optimisation_function</code> and <code>log_likelihood</code> for more info.</p>
<pre class="sourceCode r"><code class="sourceCode r">bears_fit &lt;-<span class="st"> </span><span class="kw">fit_graph</span>(bears, bears_graph)
<span class="co">#&gt; fminbnd:  Exiting: No possible improvement of cost function.</span></code></pre>
<p>The essentials about the fit can be printed with <code>print.agraph_fit</code> and visualized with <code>plot.agraph_fit</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(bears_fit)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call: inner_fit_graph(data, graph, point, Z.value, concentration, optimisation_options, </span>
<span class="co">#&gt;     parameters, iteration_multiplier, qr_tol)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; None of the proportions {a} affect the quality of the fit!</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Optimal admixture proportions:</span>
<span class="co">#&gt;   a </span>
<span class="co">#&gt; 0.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Optimal edge lengths:</span>
<span class="co">#&gt;    edge_R_BLK      edge_R_r      edge_r_s      edge_r_t     edge_s_PB </span>
<span class="co">#&gt;     0.0000000     0.0000000     0.2174268     0.0000000     0.0000000 </span>
<span class="co">#&gt;      edge_s_M edge_t_Sweden      edge_t_u  edge_u_Kenai      edge_u_v </span>
<span class="co">#&gt;     0.0000000     0.0000000     0.0000000     0.0000000     0.0000000 </span>
<span class="co">#&gt; edge_v_Denali      edge_v_M      edge_w_x      edge_w_y   edge_x_Adm1 </span>
<span class="co">#&gt;     0.0000000     0.0000000     0.0000000     0.0000000     0.0000000 </span>
<span class="co">#&gt;   edge_x_Adm2    edge_y_Bar      edge_y_z   edge_z_Chi1   edge_z_Chi2 </span>
<span class="co">#&gt;     0.0000000     0.0000000     0.0000000     0.0000000     0.0000000 </span>
<span class="co">#&gt;      edge_M_w </span>
<span class="co">#&gt;     0.0000000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Solution to a homogeneous system of edge lengths with the optimal admixture proportions:</span>
<span class="co">#&gt; Adding any such solution to the optimal one will not affect the error.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Free edge lengths:</span>
<span class="co">#&gt; edge_R_BLK</span>
<span class="co">#&gt; edge_R_r</span>
<span class="co">#&gt; edge_r_t</span>
<span class="co">#&gt; edge_s_PB</span>
<span class="co">#&gt; edge_s_M</span>
<span class="co">#&gt; edge_t_Sweden</span>
<span class="co">#&gt; edge_t_u</span>
<span class="co">#&gt; edge_u_Kenai</span>
<span class="co">#&gt; edge_u_v</span>
<span class="co">#&gt; edge_v_Denali</span>
<span class="co">#&gt; edge_v_M</span>
<span class="co">#&gt; edge_w_x</span>
<span class="co">#&gt; edge_w_y</span>
<span class="co">#&gt; edge_x_Adm1</span>
<span class="co">#&gt; edge_x_Adm2</span>
<span class="co">#&gt; edge_y_Bar</span>
<span class="co">#&gt; edge_y_z</span>
<span class="co">#&gt; edge_z_Chi1</span>
<span class="co">#&gt; edge_z_Chi2</span>
<span class="co">#&gt; edge_M_w</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounded edge lengths:</span>
<span class="co">#&gt; edge_r_s = 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Minimal error:</span>
<span class="co">#&gt; 631.518</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bears_fit)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It turned out that the value of the admixture proportion a had no effect on the minimum of the cost function. This is because our data frame wasn’t sufficient for a graph this big, which is also reflected by the fact that only one of the edge lengths (between polar bears and brown bears splitting and polar bears and the population mixing into ABC bears splitting) matter while the rest can be chosen freely. From the plot it is clear that this graph is not very convincing match with the data, and that additional gene flow from the polar bears into mainland Alaska bears would help.</p>
<p>With sufficient data the effect of admixture proportions on the cost function can be examined with the help of the functions <code>one_dimensional_plot</code> and <code>contour_plot</code>. See also <code>coef.agraph_fit</code>, <code>fitted.agraph_fit</code>, <code>print.agraph_fit</code> and <code>residuals.agraph_fit</code>.</p>
</div>
<div id="exploring-the-graph-space" class="section level1">
<h1>Exploring the graph space</h1>
<p>The number of different admixture graphs grows extremely fast with the number of leaves and admixture events, so determining the phylogeny of a given set of populations by fitting every graph to the data with brute force might not be feasible. We provide some tools for restricting the search space.</p>
<p>For just a few populations and a few admixture events <code>admixturegraph</code> contains the complete collections of possible graphs: <code>four_leaves_graphs</code> for admixture graphs with four leaves and at most two admixture events, <code>five_leaves_graphs</code> and <code>six_leaves_graphs</code> for admixture graphs with five and six leaves, respectively, and at most two admixture event, and <code>seven_leaves_trees</code> and <code>eight_leaves_trees</code> for trees with seven and eight leaves, respectively.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(four_leaves_graphs)
<span class="co">#&gt; [1] 35</span>

<span class="kw">length</span>(five_leaves_graphs)
<span class="co">#&gt; [1] 8</span>

<span class="kw">length</span>(six_leaves_graphs)
<span class="co">#&gt; [1] 21</span>

<span class="kw">length</span>(seven_leaves_trees)
<span class="co">#&gt; [1] 2</span>

<span class="kw">length</span>(eight_leaves_trees)
<span class="co">#&gt; [1] 3</span>

example_graph &lt;-<span class="st"> </span>four_leaves_graphs[[<span class="dv">15</span>]](<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>))
<span class="kw">plot</span>(example_graph, <span class="dt">draw_inner_nodes =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A given graph can be expanded to a list of bigger graphs by several functions. To add a new leaf to an existing graph use <code>add_a_leaf</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">example_list_1 &lt;-<span class="st"> </span><span class="kw">add_a_leaf</span>(example_graph, <span class="st">&quot;E&quot;</span>)

original &lt;-<span class="st"> </span>graphics::<span class="kw">par</span>()$mfrow
graphics::<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">2</span>))
for (graph in example_list_1) {
  <span class="kw">plot</span>(graph, <span class="dt">draw_inner_nodes =</span> <span class="ot">FALSE</span>)
}

graphics::<span class="kw">par</span>(<span class="dt">mfrow =</span> original)</code></pre>
<p><img src="data:image/png;base64,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9cd7GXt3+WocSU/kfFY6WPg41qA8gcyFToEMLT5WlFzE9O/X8rSWPgwNJOsJiblftz/rAdx/XlCgiO/XUgzNhyc3SQ9IYhew+6q1L9/9p+UMislnvhfvV0wgJdrme6WzVZ5mjVe9HYn6fp3mCRvB6giD+vnYaaw/PiWmr3qNA+pDWD6t/gQalJFs8AmQ70bI3FWvdUgdiM7HW/p8Nc/TYraniE7uugw+AZou8x29KwkUno+z9HUIQQbFBxt9ArRwI8Rx9K5jUHg+ztL36hCDMgQKrjSt6OsVVQwqsYBd/6unEh5rfD4hApU5BBXyJ8Sg6FjjD9C+R2VaTT51FrC3v2i5BKfqmnVcna2mgEEJ+fhKH4agGhQuUHRl251GZYuZlPNn8iceYkNNOOoGujHeoJRVySXAVLF0EArNdNACZq8abND4E6C526ztyURGmrHAhx5bBgs0/gTIef/e1GVju+lR2Ct73KxuLkuirj/CQSgw0YH+2AUaaNDwE6DF2laDQh6HnF6frdhLrb2aT27sBvWXKDEfT+la7XWUzruSnuL5DRu3a68cXxpGmXzWak8nx1DfGtlL57f7xxnjVLZTGsbwmVxLLc973PnoUV62adrqlkrDGD6T3HwQKJvhM0GgIaVhDJ8JAg0pDWP4TKoLVOckMbY0jOEzSc0n8DJ+Z6VhDJ9Jaj5xNxJ3VxrG8Jlk5jP04RBsHwQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCiRCBvnz/u7Hy8+l0+tFW+nQu/c7erbH0XPmNdbBh2PMZPmnHDroQItDnX6zb/PzJ3OnTufRPW/mX/517tg3hPIAn+xiCsOczfNKOHXQhQqD/fvvr539spY7vwsuUv/xq69U+65dvWG+BHPkMn7T7CB0h0JNjfL4jUEKWn75+dbviyGf4pIccgc7H3CfrapyzhP3wj+NobtxBcTjyGT7pEQK9zOTfn/421X62nySmnU9+axtqGJ58hk/asYMucBkPEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggE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jxCoM0Pyth0n1v696LkPmoYEjYyIWziBXu8EgfoyRqCIqrkTIQzqyoC05ROg94rpazT/kKCZ/mkHnADdFE0ijxHMdA870J9Zg8QhgoPeYTvMyOkZYukvkLEKg7ZB58wdJ9AYtAn6Ru66A4RBW6Br4s47iBi0AToLZKuyvQO93Bb60DNv/ztkGFSejnG3PALDoOr0S7vtHTL/DSEE6kpPgZrKMKg23cJufonevSixiPWkV9bKS9AYVJhOUbv+GYXm1q310E43gaQyDCpLn6Dd/4yC/ZOYemilS87aAubqorUeGukRc4A/GFSVPgIZy5p+DSOqHproELJ1Rxp+DcO5XQzKJz/jkAXstSPXaBGoB+kZ2/0JFujra7GOemiig0BBdZfXXB3bRaAeZEcc5s+z8z3pr5UYlE5ywnEL2NUIl5CcBqWTG7BzfxsqnKfkCJRNtkBhde9v2rs6xKBkUvO1+2M9ABk7PSFQLzLzDVzAPgjkqcagZBLjjfTH96satwWcR+eSKpC1znVI8T7zQKBU8tI17zjnAWi9xd3HGJRJWrhZC9h634+/12EbCLSQFa7DH79Ay40ePsOgRPIEiiyccGK22eMnnEcnkhRtsj8L7aZsQaA8cqKNXcAmBZj/BQ7rDyGClGTta0azP88z/77mdIcIlEaSQKGFc1LYBcKgNDKCdfgjCOTaIOfRWSTkGryA2V/10DcFbuJzjfYnRiAMSiJDIHNh0AHI+YYHRBKeqvOt5ZCy9ms5UIlONXwBizvBwaAMgkP1+BN2AOIQNJBwgaIrA93AoARiMx3kj7kKg8IJjTR+AYs9tiBQPJGRen9vNK4wVkdwECtQeGXwoQWBwglM1OPPgGt9Vx1YiQj08hDc+G6q+V/NWHi2Pt2ruRKJAgkIc/lFislSR6/DSsFEiEB/nDHuv+2Uggk9yss+Me2VLZWCDQQCCQQCCQQCCU6iQSLwMn5npWAi7kbi7krBAmGCBAKBBAKBBAKBBAKBBAKBBAKBBAKBBAKBRIhAX77/3Vj5dDqdvrOVfj6X/mjs9rOn12+sgwUDIQJ9/sW6p58+PT//+cnWqa3shS//O5fbhnDu9cneMawSIdB/v/318z+20ped9+VXU6njWOFw7eW4hkCBRAj0ZN8pHoEcVrhKX45XEEWEQOc16cl4CpK0hP3wj2MJMwoMJgIEetl9//70t6nWeRJtLPWdRH9rGyqY4DIeJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJP4PQ33qIjSZOb0AAAAASUVORK5CYII=" /><!-- --></p>
<p>To add a new admixture event to an existing graph use either <code>add_an_admixture</code> or <code>add_an_admixture2</code>; the former is only adding one parental edge assuming the other one already exist in the graph and the latter is detaching one edge and reattaching it with two parental edges anywhere in the original graph (provided that the result still is a valid admixture graph):</p>
<pre class="sourceCode r"><code class="sourceCode r">example_list_2 &lt;-<span class="st"> </span><span class="kw">add_an_admixture</span>(example_graph, <span class="st">&quot;b&quot;</span>)
<span class="kw">length</span>(example_list_2)
<span class="co">#&gt; [1] 69</span>
example_list_3 &lt;-<span class="st"> </span><span class="kw">add_an_admixture2</span>(example_graph, <span class="st">&quot;b&quot;</span>)
<span class="kw">length</span>(example_list_3)
<span class="co">#&gt; [1] 245</span>

<span class="kw">plot</span>(example_list_2[[<span class="dv">5</span>]], <span class="dt">draw_inner_nodes =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>None of these functions care where the original root was — its position has no effect on the predictions <code>sf2</code>, <code>sf3</code> and <code>sf4</code> as long as the admixture events remain the same. However, if we want we can select any non-admixed leaf as an outgroup, meaning that the root will be placed on the edge leading to the leaf:</p>
<pre class="sourceCode r"><code class="sourceCode r">graph_with_a_new_root &lt;-<span class="st"> </span><span class="kw">make_an_outgroup</span>(example_list_2[[<span class="dv">5</span>]], <span class="st">&quot;D&quot;</span>)
<span class="kw">plot</span>(graph_with_a_new_root, <span class="dt">draw_inner_nodes =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="references">
<h1>References</h1>
<p>Cahill, James A, Ian Stirling, Logan Kistler, Rauf Salamzade, Erik Ersmark, Tara L Fulton, Mathias Stiller, Richard E Green, and Beth Shapiro. 2015. “Genomic evidence of geographically widespread effect of gene flow from polar bears into brown bears.” <em>Molecular Ecology</em> 24 (6): 1205–17.</p>
<p>Patterson, Nick, Priya Moorjani, Yontao Luo, Swapan Mallick, Nadin Rohland, Yiping Zhan, Teri Genschoreck, Teresa Webster, and David Reich. 2012. “Ancient admixture in human history.” <em>Genetics</em> 192 (3): 1065–93.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
